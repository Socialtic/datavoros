# Alerta Veracruz Mujer

## Fechas de an√°lisis

- **An√°lisis est√°tico (mediante Exodus Privacy/MobFS):** 13/03/2023 
- **An√°lisis din√°mico (mediante an√°lisis de tr√°fico de red):** 13/03/2023
- **An√°lisis Posteriores:** 

## Archivos analizados
- [Apk versi√≥n 1.79](https://cloud.datavoros.org/index.php/s/DsMzcMdpJxtj8bS)
- [Pcap versi√≥n 1.79](https://cloud.datavoros.org/index.php/s/Sz49TpWeMAY3bR3)

## Descripci√≥n de la aplicaci√≥n
- **Tipo:** Bot√≥n de p√°nico   
- **Costo:** Gratis   
- **Link de descarga:** https://play.google.com/store/apps/details?id=com.artech.nuevoalerta.alertamujer&hl=es 
- **Descargas:** 50,000+
- **Ultima fecha de actualizaci√≥n:** 10/09/2021
- **Versi√≥n:** 1.79
- **Desarrollador:** http://www.veracruz.gob.mx/seguridad
- **Firma:** Armtech Consultores --> [GeneXus](https://www.genexus.com/es/)
- **Contacto:** appveracruz@sspver.gob.mx
- **Condiciones de uso y Pol√≠tica de privacidad:** https://alertagenero.sspver.gob.mx/alerta/avisoprivacidadmujeralerta.pdf   
Wayback Machine: https://web.archive.org/web/20230314140705/https://alertagenero.sspver.gob.mx/alerta/avisoprivacidadmujeralerta.pdf
    
- **Descripci√≥n en PlayStore:**
~~~
Veracruz Mujer Alerta es una aplicaci√≥n m√≥vil del Gobierno del Estado de Veracruz en coordinaci√≥n con la Secretar√≠a de Seguridad P√∫blica, dirigida a todas las mujeres veracruzanas para brindar asesor√≠a y asistencia con base a la Declaratoria Alerta de Violencia de G√©nero establecida en la actualidad, cuya finalidad es:

1. Identificar los Tipos y modalidades de la violencia contra la mujer.
2. Ubicar los lugares a los cuales se puede recurrir para su asesor√≠a y denunciar estos actos en tu municipio.
3. Bot√≥n para generar una alerta cuando se encuentre en situaci√≥n de violencia, estar√° enlazada con el Centro Estatal de Control, Comando, Comunicaciones y C√≥mputo (C4), quienes atender√°n la situaci√≥n y ubicaci√≥n para procesar en tiempo y forma el apoyo de las alertas que sean emitidas.

Para el uso de esta aplicaci√≥n se requieren conexi√≥n a datos m√≥viles y geolocalizaci√≥n.

Trabajamos para una vida libre de violencia de g√©nero.
~~~

## Trackers identificados (mediante Exodus Privacy)
- No hay trackers identificados

Enlace al [reporte](https://reports.exodus-privacy.eu.org/es/reports/338596/) de Exodus Privacy   

## Empresas relacionadas con esta aplicaci√≥n:
- [GeneXus](https://www.genexus.com/es/) --> Artech Consultores. Desarrolladores de la aplicaci√≥n
- [Alphabet](https://abc.xyz/) --> Google --> Sistema Android
- [Qualcomm](https://www.qualcomm.com/home) --> [Servicios de geolocalizaci√≥n](https://www.qualcomm.com/site/privacy/services) (vienen como parte del dispositivo)
- [Amazon](https://www.aboutamazon.com/) --> Almacenamiento en la nube
- [Cloudflare](https://www.cloudflare.com/) --> Almacenamiento de los servidofres de la aplicaci√≥n. 
- [Uninet](https://telmex.com/web/acerca-de-telmex/uninet) --> Almacenamiento de dominios de Google
### Dominios integrados al c√≥digo de la app que no pertecen directamente a los trackers y que son de inter√©s

- Nada que reportar



## Permisos   

- **Seg√∫n Exodus Privacy/MobFS:** 16
- **Seg√∫n prueba de uso:** 1



### Permisos seg√∫n Exodus Privacy

:round_pushpin::exclamation:ACCESS_BACKGROUND_LOCATION   
*Access location in the background*

:round_pushpin::exclamation:ACCESS_COARSE_LOCATION   
*Access approximate location only in the foreground*

:round_pushpin::exclamation:ACCESS_FINE_LOCATION   
*Access precise location only in the foreground*

ACCESS_NETWORK_STATE   
*View network connections*

ACCESS_WIFI_STATE   
*View Wi-Fi connections*

CHANGE_NETWORK_STATE   
*Change network connectivity*

FOREGROUND_SERVICE   
*Run foreground service*

INTERNET   
*Have full network access*

:exclamation::busts_in_silhouette:READ_CONTACTS   
*Read your contacts*

VIBRATE   
*Control vibration*

WAKE_LOCK   
*Prevent phone from sleeping*

:exclamation::busts_in_silhouette:WRITE_CONTACTS    
*Modify your contacts*

:exclamation::file_folder:WRITE_EXTERNAL_STORAGE   
*Modify or delete the contents of your shared storage*

C2D_MESSAGE

RECEIVE

READ_GSERVICES

El icono :exclamation: indica un nivel 'Peligroso' o 'Especial' de acuerdo a los [niveles de protecci√≥n de Google](https://developer.android.com/guide/topics/permissions/overview). 

### Permisos seg√∫n la Playstore

:busts_in_silhouette:Contactos
- consultar tus contactos
- modificar tus contactos

:round_pushpin:Ubicaci√≥n
- ubicaci√≥n aproximada (basada en red)
- ubicaci√≥n precisa (basada en red y GPS)

:camera:Fotos/Multimedia/Archivos
- leer el contenido de tu almacenamiento USB
- modificar o eliminar 

:file_folder:Almacenamiento
- leer el contenido de tu almacenamiento USB
- modificar o eliminar contenido del almacenamiento USB

Informaci√≥n sobre la conexi√≥n WI-Fi
- ver conexiones Wi-Fi

:grey_question:Otro motivo
- recibir datos de Internet
- ver conexiones de red
- cambiar conectividad de red
- acceso completo a red
- controlar vibraci√≥n
- impedir que el disositivo entre en modo de suspensi√≥n
- leer la configuraci√≥n de los servicios de Google


### Permisos solicitados durante el uso de la aplicaci√≥n

- üî¥ Acceso a la ubicaci√≥n

üî¥ Este √≠cono indica un permiso obligatorio   


## Datos

### Datos solicitados al usuario durante el uso de la aplicaci√≥n

- üî¥ N√∫mero de tel√©fono
- üî¥ Nombre
- üî¥ Apellido
- üî¥ Fecha de nacimiento
- üî¥ Contacto de emergencia y n√∫mero
- ‚ö™ Segundo contacto de emergencia
- ‚ö™ Foto: como archivo o a trav√©s de la c√°mara

    
üî¥ Este √≠cono indica que se debe ingresar este dato de manera obligatoria.   
‚ö™ Este √≠cono indica que estos datos son opcionales.


### Tabla de conexiones realizadas durante el uso de la aplicaci√≥n

| Direcci√≥n IP    | N√∫mero de paquetes | Pa√≠s          | Ciudad        | N√∫mero AS | Organizaci√≥n AS     | Dominio contactado         |
|-----------------|--------------------|---------------|---------------|-----------|---------------------|----------------------------|
| 104.21.64.97    |               3777 | United States | San Francisco |     13335 | CLOUDFLARENET       | alertagenero.sspver.gob.mx |
| 108.156.211.37  |                 50 | United States |               |     16509 | AMAZON-02           | izatcloud.net              |
| 142.250.65.110  |                 48 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.250.65.138  |                 52 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.250.65.142  |                330 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.250.69.54   |                138 | United States |               |     15169 | GOOGLE              | googleusercontent.com      |
| 142.250.113.188 |                 59 | United States |               |     15169 | GOOGLE              | mtalk.google.com           |
| 142.250.114.188 |                 23 | United States |               |     15169 | GOOGLE              | mtalk.google.com           |
| 142.250.115.188 |                 70 | United States |               |     15169 | GOOGLE              | mtalk.google.com           |
| 142.251.33.227  |                100 | United States |               |     15169 | GOOGLE              | gstatic.com                |
| 142.251.33.234  |                  6 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.3    |                 32 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.10   |                260 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.42   |                  4 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.106  |                 39 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.138  |                 45 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.142  |                743 | United States |               |     15169 | GOOGLE              | clientes.l.google.com      |
| 142.251.34.202  |                 63 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.234  |                 85 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 142.251.34.238  |                280 | United States |               |     15169 | GOOGLE              | clients.google.com         |
| 142.251.35.14   |                 28 | United States |               |     15169 | GOOGLE              | clients.google.com         |
| 142.251.218.138 |                149 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 172.67.180.234  |               2244 | United States | San Francisco |     13335 | CLOUDFLARENET       | alertagenero.sspver.gob.mx |
| 172.217.1.227   |                100 | United States |               |     15169 | GOOGLE              | gvt2.com                   |
| 172.217.2.138   |                 46 | United States |               |     15169 | GOOGLE              | googleapis.com             |
| 189.247.22.14   |                393 | Mexico        |               |      8151 | Uninet S.A. de C.V. | gvt1.com                   |
| 189.247.22.17   |               1786 | Mexico        |               |      8151 | Uninet S.A. de C.V. | gvt1.com                   |
| 189.247.22.18   |                109 | Mexico        |               |      8151 | Uninet S.A. de C.V. | gvt1.com                   |
| 189.247.22.78   |               5058 | Mexico        |               |      8151 | Uninet S.A. de C.V. | gvt1.com                   |
| 189.247.22.80   |                321 | Mexico        |               |      8151 | Uninet S.A. de C.V. | gvt1.com                   |
| 216.58.195.234  |               3206 | United States |               |     15169 | GOOGLE              | googleapis.com             |



- Seg√∫n esta [p√°gina](https://www.geolocation.com/es?ip=104.21.64.97#ipresult) la localizaci√≥n del servidor con direcci√≥n 104.21.64.97 (que es host de la aplicaci√≥n) es San Francisco, California, Estados Unidos.
- Lo [mismo](https://www.geolocation.com/es?ip=172.67.180.234#ipresult) para el servidor con direcci√≥n ip 172.67.180.234 (el otro servidor de la aplicaci√≥n). 
- Los dominios contactados de Uninet en M√©xico pertencen a Google. 

### Mapa de conexiones realizadas durante el uso de la aplicaci√≥n

![Mapa](./mapa.png)


### Datos compartidos y uso seg√∫n la Playstore:

- Como esta aplicaci√≥n no se ha actualizado desde septiembre de 2021, no han agregado estos datos en la PlayStore.

### Datos recopilados y uso seg√∫n la Pol√≠tica de privacidad

- En la [pol√≠tica de privacidad](https://alertagenero.sspver.gob.mx/alerta/avisoprivacidadmujeralerta.pdf) no se indican qu√© datos recaban de la persona usuaria, solamente su uso:
    - Prevenci√≥n y detecci√≥n de violencia de g√©nero
    - Brindar informaci√≥n sobre los tipos y modalidades de violencia de g√©nero
    - Recabar datos estad√≠sticos sobre la violencia de g√©nero en el estado de Veracruz
    - Brindar atenci√≥n y/o orientaci√≥n a las v+ictimas
    - Estad√≠sticas de control interno
    - Brindar atenci√≥n en momentos de emergencia
    - Env√≠o de mensajes emergentes con informaci√≥n sobre tipos y modalidades de la violencia de g√©nero

- Los datos personales ser√°n compartidos con autoridades distintas al responsable de la aplicaci√≥n. Para revisar esto, redirige al [aviso de privacidad integral](http://www.veracruz.gob.mx/seguridad/avisos-de-privacidad-y-sistemas-de-datos-personales-de-las-diferentes-areas/) (el de la aplicaci√≥n y el de la PlayStore son simplificados). Este aviso no aparece en la p√°gina. 




### Otros datos recolectados:

- Sabemos, gracias a analizar el tr√°fico de red, que los servidores de la aplicaci√≥n tambi√©n recolectan:
    - Lugar
    - Idioma
    - Versi√≥n Android
    - Generan un ID del dispositivo
    - Nombre del dispositivo (cada dispositivo tiene un nombre que no es comercial para identificar cada versi√≥n, en este caso "doha")


## Funciones particulares de la aplicaci√≥n:
- La aplicaci√≥n cuenta con variada informaci√≥n que incluye:
    - Qu√© es la alerta de g√©nero
    - Tipos de violencia de g√©nero
    - Modalidades de dicha violencia
    - Un directorio que permite localizar, de acuerdo al municipio de Veracruz que se necesite, oficinas para hacer denuncias
    - N√∫meros de tel√©fono de atenci√≥n
    - Violent√≥metro
    - Parecer√≠a adem√°s tener una suerte de historial de las alarmas de g√©nero hechas por la persona usuaria (no sirve)
    - A la hora de activar el bot√≥n de p√°nico se puede mandar un mensaje y agregar una imagen. 

### Notas importantes sobre seguridad y privacidad:

- La aplicaci√≥n fue firmada por una empresa uruguaya llamada originalmente Artech Consultores y ahora llamada [Genexus](https://www.genexus.com/es/)
- Las comunicaciones a los servidores de la aplicaci√≥n (104.21.64.97 y 172.67.180.234), que pertenecen a CloudFlare, no est√°n cifradas. Pruebas [1](/docs/01-apps-de-seguridad/mujer_alerta_veracruz/captura_pantalla_sin_cifrado/mujer_alerta_registro.png),[2](./captura_pantalla_sin_cifrado/mujer_alerta_datospersonales2.png). Esto quiere decir que los datos personales de los usuarios (todos aquellos usados para el registro y que son enviados al servidor 104.21.64.97) adem√°s de las alertas de p√°nico [3](./captura_pantalla_sin_cifrado/alerta_mujer_alerta.png) son susceptibles de ser interceptados por un atacante. A este servidor tambi√©n se mandan datos de la geolocalizaci√≥n de la persona usuaria y tampoco est√°n cifrados [4](./captura_pantalla_sin_cifrado/alerta_mujer_geolo.png) 
- Tampoco los metadatos (de la secci√≥n "otros datos recolectados") est√°n cifrados como se ve en la captura de pantalla n√∫mero 2. 
- Hay dos permisos, leer contactos y modificar contactos que pudieran ser de peligro, y la aplicaci√≥n ni siquiera los utiliza, ya que no tienen ninguna funci√≥n asociada.
- Para registrarse en la aplicaci√≥n, la persona usuaria no recibe ning√∫n mensaje por SMS para validar el n√∫mero de celular. Nosotros nos registramos con un n√∫mero inventado.
- Una vez registrado, la persona usuaria puede cambiar el n√∫mero con el que se registr√≥. La propia aplicaci√≥n otorga, como se ve en [esta](/docs/01-apps-de-seguridad/mujer_alerta_veracruz/captura_pantalla/mujer_alerta_veracruz%20(29).png) captura de pantalla, el c√≥digo de verificaci√≥n. Esto permite registrar cualquier n√∫mero de celular. 
- Mandamos una alerta y se guard√≥ con un folio [5](./captura_pantalla/mujer_alerta_veracruz%20(31).png). Despu√©s de activar la alarma, esta se puede desactivar [6](./captura_pantalla/mujer_alerta_veracruz%20(32).png). El problema es que no se puede volver a activar en 30 min. Comprobamos y, en efecto, despu√©s de 30 minutos ya se pudo volver a utilizar. 
- Instalamos y desinstalamaos la aplicaci√≥n varias veces y ya no nos volvi√≥ a solicitar ning√∫n registro. De hecho, cambiamos la SIM, y fue igual. Una vez instalada se puede cambiar el n√∫mero registrado sin ning√∫n problema, y se puede reinstalar varias veces y los datos se mantienen. Parecer√≠a que la instalaci√≥n se asocia con el dispositivo, m√°s que con el n√∫mero de tel√©fono.  
- Si no se tiene Google Maps instalado, la aplicaci√≥n no puede mostrar mapas.
- Aplicaci√≥n deber√≠a solo funcionar para Android versi√≥n 10 y anteriores como lo indica el [an√°lisis](./captura_pantalla/alerta_mujer_sdk.png) de MobSF, pero logramos instalarla en versiones posteriores (12 y 13). De hecho, en la versi√≥n con Android 10 nunca logramos activar la alarma. 
- Los datos personales de las personas usuarias son guardados en servidores que est√°n fuera de la Rep√∫blica Mexicana.
- Cuando uno no ha mandado todav√≠a ninguna alerta, la funci√≥n de "Mis alertas" primero muestra un mapa del mundo; la segunda vez que entramos a esta funci√≥n muestra una serie de alertas a lo largo de la Rep√∫blica Mexicana.  
- Los servidores de Uninet contactados tienen dominios de Google. 

## Conclusiones

- Las comunicaciones no cifradas representan un riesgo muy alto de seguridad. Las personas usuarias podr√≠an ser v√≠ctimas de un "ataque de hombre en el medio".
- La posibilidad de registrar cualquier n√∫mero de celular y cambiarlo sin ning√∫n tipo de validaci√≥n podr√≠a representar un riesgo de seguridad.
- Consideramos que el no poder activar la alarma de nuevo en un espacio de 30 min. es un problema de seguridad para las personas usuarias ya que si por alg√∫n error desactivaron la primera alarma, ya no pueden usar la aplicaci√≥n. 
- El hecho de que la aplicaci√≥n no nos haya funcionado en Android 10 (no pudimos probarlo en otros celulares) podr√≠a ser un problema si no se le avisa a la poblaci√≥n de este problema (si es que realmente existe y no fue un problema relacionado directamnete con nuestros equipos). 
- No hay rastreadores, lo que es bueno, y los datos enviados a otras empresas son m√≠nimos y coinciden con los est√°ndares de las aplicaciones en Android. 
- La falta de rastreadores que analicen fallos en la aplicaci√≥n podr√≠a suponer un problema en la calidad del desarrollo de la aplicaci√≥n.
