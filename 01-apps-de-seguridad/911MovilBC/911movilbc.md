# 911M√≥vilBC

## Fecha de an√°lisis

- **An√°lisis est√°tico (mediante Exodus Privacy):** 12 abril 2022    
- **An√°lisis din√°mico (mediante captura de tr√°fico de red):** 18 abril 2022    
- **An√°lisis posteriores:** 20 mayo 2022 / 07 septiembre 2022 / 17 octubre 2022 

## Descripci√≥n de la aplicaci√≥n

- **Tipo:** Aplicaci√≥n de emergencias de Baja California   
- **Costo:** Gratuito   
- **Link:** [https://play.google.com/store/apps/details?id=com.c4bc.alerta066m](https://play.google.com/store/apps/details?id=com.c4bc.alerta066m)        
- **Descargas:** 50,000+  
- **Fecha de actualizaci√≥n:** ~~03 Diciembre 2021/ 19 Abril 2022~~ / 26 Septiembre 2022   
- **Versi√≥n:**  5.5.14/5.6.0/5.7.1  
- **Desarrollador:**  [http://www.seguridadbc.gob.mx/](http://www.seguridadbc.gob.mx/)  
- **Firma:**  C4       
- **Contacto:**  911movilbc@seguridadbc.gob.mx   
- **Condiciones de uso y Pol√≠tica de privacidad:**  
  - [http://www.seguridadbc.gob.mx/contenidos/movilpp.php](http://www.seguridadbc.gob.mx/contenidos/movilpp.php)  

- **Descripci√≥n en la PlayStore:**       
~~~
Por sus funcionalidades y casos de √©xito es GANADORA DE RECONOCIMIENTOS ESTATALES Y NACIONALES:

1. Premio I+T GOB 2015 - Entregado por el Comite de Inform√°tica de la Administraci√≥n P√∫blica
Estatal y Municipal (CIAPEM) el 1-Dic-2015
2. Premio M√°s Innovadoras Sector P√∫blico 2015 - Entregado por la revista InnovationWeek el 5-Nov-2015
3. Premio Estatal de Ciencia y Tecnolog√≠a 2014 - Entregado por el Consejo de Ciencia y Tecnolog√≠a
de Baja California (COCYTBC) el 4-Dic-2014

El Gobierno del Estado de Baja California a trav√©s de la Secretar√≠a de Seguridad Ciudadana, pone a
disposici√≥n de sus ciudadanos y visitantes el aplicativo denominado ‚Äú911MovilBC‚Äù que permite a los usuarios
de tel√©fonos m√≥viles realizar peticiones de atenci√≥n de emergencias a trav√©s de la red de datos y
l√≠nea telef√≥nica.

Realiza una llamada al n√∫mero 911 enviando tu ubicaci√≥n de forma autom√°tica a trav√©s la red
de datos permitiendo un ahorro importante en los tiempos para la atenci√≥n de la emergencia y con
ello facilitar la atenci√≥n por parte de las instituciones encargadas de brindar la atenci√≥n.

*A trav√©s de esta aplicaci√≥n puedes realizar las siguientes funciones:

1. Llamada al 911 con ubicaci√≥n (GPS).
2. Conversaci√≥n mediante texto (Chat) para contactar a un operador telef√≥nico con ubicaci√≥n (GPS).
3. Bot√≥n de Emergencia con ubicaci√≥n (GPS).
4. Notificaciones de Alerta Amber, Menores y Personas Desaparecidas.
5. Gu√≠as Informativas (Que hacer en caso de emergencias y prevenci√≥n de delitos)
6. Perfil M√©dico para Alerta066-Persona Vulnerable.

Ejemplos de uso de la herramienta:

- Accidentes de tr√°nsito   
- Incendios   
- Delitos en progreso   
- Fugas de materiales peligrosos   
- Lesiones   

Te invitamos a realizar un uso adecuado de este servicio.
~~~

## Trackers identificados (mediante Exodus Privacy)

- [Google Firebse Analytics](https://firebase.google.com/products/analytics)


## Empresas relacionadas con esta aplicaci√≥n

- Google (Tracker y ubicaci√≥n)
- Tel√©fonos del Noroeste (Servidor donde est√° almacenada la aplicaci√≥n)

## Permisos

- **Seg√∫n la Playstore:** 20 permisos.  
- **Seg√∫n Exodus Privacy:** 22 permisos.   
- **Seg√∫n prueba de uso:** 7 permisos que se piden de manera expl√≠cita.   


### Permisos seg√∫n la PlayStore

Esta aplicaci√≥n tiene acceso a:   

- ![imagen](https://user-images.githubusercontent.com/102829552/165589440-63853abc-5ae8-4677-b60e-f605577e9881.png):
Ubicaci√≥n

    - Ubicaci√≥n aproximada (seg√∫n la red)
    - Ubicaci√≥n precisa (seg√∫n el GPS y la red)


- ![imagen](https://user-images.githubusercontent.com/102829552/165589549-160b571e-067e-4a71-8000-31bce52a530b.png)
Tel√©fono

    - Llamar directamente a n√∫meros de tel√©fono
    - Consultar la identidad y el estado del dispositivo


- ![imagen](https://user-images.githubusercontent.com/102829552/165589563-392a213f-de5f-4f8e-8e59-4e0e2da106c5.png)
Fotos/datos multimedia/archivos

    - Leer el contenido del dispositivo USB
    - Modificar o eliminar el contenido del almacenamiento USB


- ![imagen](https://user-images.githubusercontent.com/102829552/165589583-3643317c-7847-4567-bd85-bed17a4e5237.png)
Almacenamiento

    - Leer el contenido del dispositivo USB
    - Modificar o eliminar el contenido del almacenamiento USB

- ![imagen](https://user-images.githubusercontent.com/102829552/165589611-9dec40f8-a24a-4fa3-bdf8-922ffc380ce1.png)
C√°mara

    - Realizar fotograf√≠as y grabar videos


- ![imagen](https://user-images.githubusercontent.com/102829552/165589638-f18b4fc4-a4b2-40a7-b356-b894b848c459.png)
Micr√≥fono

    - Grabar sonido


- ![imagen](https://user-images.githubusercontent.com/102829552/165589662-61f0133f-2933-45d5-9789-fde06ef0785b.png)
ID de dispositivo y datos de llamadas

    - Consultar la identidad y el estado del tel√©fono


- ‚ùî Otro

    - Recibir datos desde Internet
    - Ver conexiones de red
    - Acceso completo a la red
    - Cambiar tu configuraci√≥n de audio
    - Ejecutarse al inicio
    - Mostrar sobre otras aplicaciones
    - Controlar vibraci√≥n
    - Impedir que el dispositivo entre en modo de suspensi√≥n
    - Leer la configuraci√≥n de los servicios de Google

### Permisos seg√∫n Exodus Privacy

- ![imagen](https://user-images.githubusercontent.com/102829552/165589993-2aa5535d-fbb0-45a7-84b5-ad709cf3fcc0.png):exclamation:
ACCESS_COARSE_LOCATION   
_Access approximate location (network-based)_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590054-3a904660-1a3b-4967-bf4b-3f39c3fb59f6.png):exclamation:
ACCESS_FINE_LOCATION   
_Access precise location (GPS and network-based)_

- ACCESS_NETWORK_STATE   
_View network connections_

- ACCESS_NOTIFICATION_POLICY   
_Access Do Not Disturb_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590152-18dcfe36-f5d6-4d7a-87b0-1dc847770edb.png):exclamation:
ANSWER_PHONE_CALLS   
_Answer phone calls_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590185-951a1268-6bd9-448c-b2ff-00ac08d9d377.png):exclamation:
CALL_PHONE    
_Directly call phone numbers_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590237-49e9bf90-9c95-44ae-aea7-5cbecf02a35d.png):exclamation:
CAMERA    
_Take pictures and videos_

- FOREGROUND_SERVICE    
_Run foreground service_

- INTERNET   
_Have full network access_

- MODIFY_AUDIO_SETTINGS    
_Change your audio settings_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590322-82cf5301-63b1-4ae9-858b-7e3bf648a9ed.png):exclamation:
READ_EXTERNAL_STORAGE    
_Read the contents of your SD card_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590348-1a1efafb-12c4-46c2-ac22-8540514a449d.png):exclamation:
READ_PHONE_STATE    
_Read phone status and identity_

- RECEIVE_BOOT_COMPLETED    
_Run at startup_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590598-3ec3dbf0-a00c-4e09-a1b7-9db7b4487f6b.png):exclamation:
RECORD_AUDIO   
_Record audio_

- :exclamation:SYSTEM_ALERT_WINDOW   
_This app can appear on top of other apps_

- VIBRATE   
_Control vibration_

- WAKE_LOCK   
_Prevent phone from sleeping_

- ![imagen](https://user-images.githubusercontent.com/102829552/165590732-a1dc116c-14a1-41c0-9d16-025d764f9d2b.png):exclamation:
WRITE_EXTERNAL_STORAGE   
_Modify or delete the contents of your SD card_

- MAPS_RECEIVE   

- RECEIVE   

- BIND_GET_INSTALL_REFERRER_SERVICE   

- READ_GSERVICES    

El icono :exclamation: indica un nivel 'Peligroso' o 'Especial' de acuerdo a los [niveles de protecci√≥n de Google](https://developer.android.com/guide/topics/permissions/overview).

### Permisos solicitados al usuario durante el uso de la aplicaci√≥n

*Antes de aceptarlos aparece una leyenda que informa al usuario que de no aceptarlos, la aplicaci√≥n no funcionar√°. Las notificaciones aparecen una tras otras solicitando los permisos*

- üî¥ Acceso a tomar Fotos y V√≠deos
- üî¥ Acceso a ubicaci√≥n
- üî¥ Acceso a grabar audio
- üî¥ Acceso a realizar y administrar llamadas
- üî¥ Acceso a fotos y contenido multimedia
- üî¥ Acceso a poner en modo silencioso
- üî¥ Acceso a mostrar sobre otras apps

üî¥ Este √≠cono indica un permiso obligatorio

## Datos

### Datos solicitados al usuario durante el uso de la Aplicaci√≥n

- üî¥ N√∫mero de tel√©fono
- üî¥ Correo Electr√≥nico
- üî¥ Nombre
- üî¥ Apellido Paterno
- ‚ö™Apellido Materno
- üî¥ Municipio *S√≥lo est√°n disponibles los de Baja California*
- :red_circle: Sexo
- :red_circle: Fecha de nacimiento
- ‚ö™ Perfil M√©dico
  - Tipo de sangre (Incorporado en la √∫ltima versi√≥n, _5.6.0_)
  - Alergias a medicamentos
  - Alergias a alimentos
  - Padecimientos
  - Medicamentos
  - Informaci√≥n adicional   

üî¥ Este √≠cono indica que se debe ingresar este dato de manera obligatoria.   
‚ö™ Este √≠cono indica que estos datos son opcionales.



### Tabla de conexiones realizadas durante el uso de la aplicaci√≥n

| Direcci√≥n IP   | N√∫mero de paquetes | Pa√≠s          | Ciudad  | N√∫mero AS | Organizaci√≥n AS                      |
|----------------|--------------------|---------------|---------|-----------|--------------------------------------|
| 142.250.68.10  |                 88 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.142 |                 45 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.174 |               1979 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.227 |                212 | United States |         |     15169 | GOOGLE                               |
| 142.250.72.234 |                 98 | United States |         |     15169 | GOOGLE                               |
| 142.250.176.10 |                 23 | United States |         |     15169 | GOOGLE                               |
| 142.250.189.10 |                 36 | United States |         |     15169 | GOOGLE                               |
| 142.250.200.3  |                 21 | United States |         |     15169 | GOOGLE                               |
| 142.251.34.170 |                 31 | United States |         |     15169 | GOOGLE                               |
| 142.251.40.35  |                 47 | United States |         |     15169 | GOOGLE                               |
| 142.251.40.42  |                 92 | United States |         |     15169 | GOOGLE                               |
| 142.251.40.46  |                 29 | United States |         |     15169 | GOOGLE                               |
| 142.251.132.3  |                 65 | United States |         |     15169 | GOOGLE                               |
| 200.76.246.116 |              13556 | M√©xico        | Tijuana |      6332 | Telefonos del Noroeste, S.A. de C.V. |
| 200.76.246.123 |                503 | M√©xico        | Tijuana |      6332 | Telefonos del Noroeste, S.A. de C.V. |
| 216.239.32.3   |                 17 | United States |         |     15169 | GOOGLE                               |

### Mapa de conexiones

_Pendiente_

### Notas sobre datos recolectados

- La aplicaci√≥n contacta a los servidores de google por dos razones: los mapas y la geolocalizaci√≥n y por el tracker de Firebase. Firebase recolecta toda una serie de eventos realizados en la aplicaci√≥n. Aqu√≠ los enlaces a todos los eventos y datos que, de manera est√°ndar se recolectan [1](https://support.google.com/firebase/answer/9234069?hl=en&ref_topic=6317484&visit_id=637859685880636053-1936242821&rd=1), [2](https://support.google.com/firebase/answer/9268042?hl=en&ref_topic=6317484&visit_id=637859685880636053-1936242821&rd=1), [3](https://support.google.com/firebase/answer/7029846?hl=en&ref_topic=7029512).

- El servidor 066movilbc.seguridadbc.gob.mx con IP: 200.76.246.123 200.76.246.116 son el _Host_ de la app. Todos los datos que el usuario debe introducir son guardados ah√≠. Las llamadas se hacen en texto plano, HTTP, lo que implica una brecha de seguridad enorme. Se pueden ver los siguientes datos (adem√°s de los proporcionados por el usuario) en las llamadas http:
   - ID de usuario
   - Nuevo Equipo (si al acceder con un n√∫mero ya registrado, se est√° accediendo desde otro equipo al original)
N√∫mero de tel√©fono
   - N√∫mero de confirmaci√≥n que se usa para acceder a la aplicaci√≥n y si este fue aceptado por el servidor de manera correcta.
   - Marca del celular
   - Modelo del celular
   - Sistema Operativo
   - Versi√≥n del sistema Operativo  
   - Firebase Token
- Las notificaciones de emergencia hechas con el bot√≥n Violencia de G√©nero (_Bot√≥n Violeta_ en la nueva versi√≥n) y el Bot√≥n de P√°nico, se hacen mediante HTML y tampoco est√°n cifradas. Incluyen estos datos:
   - N√∫mero de tel√©fono
   - Ubicaci√≥n
   - Direcci√≥n (aunque no existe esta funci√≥n)
   - Si el n√∫mero desde el que se mand√≥ la alerta pertenece a una empresa de seguridad privada.
   - N√∫mero de incidente
- ~~La p√°gina [www.seguridad.gob.mx](www.seguridad.gob.mx), en la cual est√°n las funciones de "Estad√≠sticas", "Desaparici√≥n de menores" y "Qu√© hacer", a veces est√° cifrada con HTTPS, y a veces no~~  

### Seguridad de datos de la PlayStore

**Seguridad de datos**
- El desarrollador indica que esta aplicaci√≥n no recoge ni comparte datos de usuario.

**No se comparten datos con terceros**
- El desarrollador indica que esta aplicaci√≥n no comparte datos de usuario con otras empresas u organizaciones.

**No se recogen datos**
- El desarrollador indica que esta aplicaci√≥n no recoge datos de usuario.



## Tabla de relaci√≥n entre permisos y funciones

| Permisos  | Funci√≥n relacionada  |
|---|---|
| ACCESS_COARSE_LOCATION  | Servicio de ubicaci√≥n  |
| ACCESS_FINE_LOCATION  | Servicio de ubicaci√≥n  |
| ACCESS_NETWORK_STATE  | Internet  |
| ACCESS_NOTIFICATION_POLICY | Bot√≥n de p√°nico  |
| ANSWER_PHONE_CALLS  | LLamada 911  |
| CALL_PHONE  | Llamadas 911  |
| CAMERA  | Chat (Suponemos esto, debido a funciones similares en otras apps) |
| FOREGROUND_SERVICE  | Llamadas de extorsi√≥n, Bot√≥n de p√°nico  |
| INTERNET  | Internet  |
| MODIFY_AUDIO_SETTINGS  | Bot√≥n de p√°nico, chat.  |
| READ_EXTERNAL_STORAGE  | Subit fotos al chat  |
| READ_PHONE_STATE  | Llamada 911  |
| RECEIVE_BOOT_COMPLETED  | Llamada de extorsi√≥n  |
| RECORD_AUDIO  | Bot√≥n de p√°nico   |
| SYSTEM_ALERT_WINDOW  | Llamadas de extorsi√≥n  |
| VIBRATE  | Bot√≥n de p√°nico   |
| WAKE_LOCK  | Bot√≥n de p√°nico  |
| WRITE_EXTERNAL_STORAGE  | Chat  |
| MAPS_RECEIVE  | Permiso innecesario  |
| RECEIVE  | Push notifications  |
| BIND_GET_INSTALL_REFERRER_SERVICE  | Permiso relacionado con el tracker de Firebase  |
| READ_GSERVICES  | Servicio de ubicaci√≥n  |

### Funciones espec√≠ficas de la aplicaci√≥n

- Tiene una funci√≥n de activar el perfil de Seguridad Privada cuando el n√∫mero registrado sea de un empresa de Seguridad Privada.
- La funci√≥n "Estad√≠sticas" remite a la p√°gina [www.seguridadbc.gob.mx/ExtorsionTelefonica/engano.php](www.seguridadbc.gob.mx/ExtorsionTelefonica/engano.php) donde se pueden revisar los n√∫meros denunciados por extorsi√≥n, las zonas de donde provienen y otros datos.
- Funci√≥n "Menores desaparecidos" permite el acceso a la base datos de menores desaparecidos en sus categor√≠as de Alerta Amber, Regionales, Nacionales y casos resueltos.
- La funci√≥n "Qu√© hacer" remite a una serie de gu√≠as de la p√°gina de la Secretaria de Seguridad Ciudadana.

## Notas

- Dentro de la funci√≥n "Perfil M√©dico", la funci√≥n de Contactos (que son probablemente contactos de emergencia), cierra la app.
- La funci√≥n de n√∫meros de extorsi√≥n se queda activa aunque uno cierre sesi√≥n en la aplicaci√≥n, o la cierre por completo.
- No se prob√≥ la funci√≥n chat por estar fuera del √°rea de servicio, lo mismo con el bot√≥n de p√°nico, la llamada a 911 y el _bot√≥n violeta_. Sin embargo sabemos que estas se hacen en HTTP y no HTTPS.
- No se prob√≥ la funci√≥n Apoyo a cuentahbiente ya que s√≥lo est√° disponible en Tijuana.

## Conclusiones

- La aplicaci√≥n tiene un problema de seguridad enorme al no cifrar las comunicaciones entre el usuario y el servidor _host_ de la app. Esto, adem√°s, implica la pregunta obvia de si los datos que almacenan de los usuarios est√°n cifrados o no y qui√©n tiene acceso a ellos.
- La relaci√≥n entre permisos y funciones es sim√©trica salvo el permiso _maps_receive_ que ya no es necesario para el funcionamiento de google maps desde la versi√≥n 3.1.59 de Google Services.
- Para reiniciar sesi√≥n solamente se requiere el n√∫mero de tel√©fono y proporcionar un email (que no necesariamente tiene que ser con el que se registr√≥ un usuario), de tal manera que uno puede acceder a los datos de un usuario ya registrado con s√≥lo conocer su n√∫mero de tel√©fono.  
- ~~A pesar que maneja datos sensibles (seg√∫n la ley de Privacidad de datos de M√©xico), no pide en ning√∫n momento aceptar de manera expresa la pol√≠tica de privacidad o los T√©rminos de uso~~  

## Adenda actualizaci√≥n versi√≥n 5.6.0
- Se agreg√≥ la opci√≥n de Bot√≥n Violeta. 
- No realizamos ning√∫n nuevo an√°lisis.

## Adenda actualizaci√≥n versi√≥n 5.7.1
- Agregamos la secci√≥n de Seguridad de datos que ahora aparece en la PlayStore.
- Hicimos un an√°lisis de tr√°fico de red. Los problemas de cifrado no han sido arreglados.
- La secci√≥n Gu√≠a ¬øQu√© hacer? Ahora tiene nuevas secciones (revisar captura de pantalla). No todas las secciones reidirigen a la p√°gina dela SSC. Varias entradas no sirven todav√≠a.
- El aviso de privacidad se tiene que aceptar de manera expresa.
- Persiste la falla de seguridad de reinicio de sesi√≥n. 
- La lista de conexiones se mantiene igual, por eso no agregamos una nueva tabla de conexiones. 